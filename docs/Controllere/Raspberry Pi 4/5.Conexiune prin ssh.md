<h1>5.Conexiune prin ssh</h1>

<h2 id="top">Chapters</h2>
1. <a href="#configurare">Configurare ssh</a><br>
2. <a href="#definitiv">Setare hardware definitiv</a><br>
A) <a href="#ip">Pt conectare prin IP</a><br>
B) <a href="#hostname">Pt conectare prin domeniu</a><br>

<h2 id="configurare">Configurare ssh</h2>

Acum ca am reusit sa configuram cat de cat consola, urmeaza sa trecem la adevarata putere: a te conecta la Rasperry Pi remotely, prin ssh.<br>
Deja am configurat o cheie la instalarea Rasberry OS, si am pregatit cheia pentru acest pas.

**Step 1**<br>
Primul pas ce trebuie sa-l mai facem este sa activam conexiunea prin SSH. Default aceasta este dezactivata.<br>
Pentru aceasta, dupa ce am deschis OBS Studio, si ne-am logat introducem:
```
	sudo raspi-config
```

**Step 2**<br>
De pe ecrn selectam *Interface Options*, apasnd *Enter*.

<img src="_img/5/ssh1.PNG" alt="ssh1" />

**Step 3**<br>
Apoi selectm *SSH*, apasand *Enter*.<br>
Sagetile sus si jos sunt pentru a naviga in meniu, iar stanga dreapta, pentru a selecta butoanele de jos.

<img src="_img/5/ssh2.PNG" alt="ssh2" />

**Step 4**<br>
Apasam pe *Enter*, atunci cand apare acest prompt

<img src="_img/5/ssh3.PNG" alt="ssh3" />

urmat de inca un *Enter* la notificarea ca ssh a fost activat.

<img src="_img/5/ssh4.PNG" alt="ssh4" />

**Step 5**<br>
La final selectm *Finish*, si dam *Enter*.<br>
I-am dat si un `reboot` just in case, insa am deconectat Rasperry Pi, de la monitorul de laptop, si de la alimentare, intrucat urmeaza urmatorul pas.

<h2 id="definitiv">Setare hardware definitiv</h2>

Acum urmeaza sa facem setarea hardware finala.<br>
In cazul meu arata cam asa:

<img src="_img/5/ssh5.JPG" alt="ssh5" />

- un rooter
- un switch
- Raspberry Pi

Toate cu incarcatorul lor, si conectate cu cablu LAN.<br>Am folosit si un burete de vase pt a desparti si izolat termic switchul de router.<br>
Spre surprinderea mea cel mai incalzit dispozitiv este routerul.

<h3>Legatura cabluri de date</h3>

<img src="_img/5/ssh6.png" alt="ssh6" />

Internetul vine prin fibra optica la router. Routerul trimite internetul la Switch prin cablu LAN, iar de-acolo internetul pleaca mai departe la Raspberry Pi, sau la mine la Calculator.

<h2>Conexiune software la Raspberry Pi</h2>

Aici, eu voi folosi [KiTTY](https://github.com/cyd01/KiTTY), dar si [PuTTY](https://www.puttygen.com/download-putty) este ok. Diferenta intre acestea este ca cu *KiTTY* pot deschide mai multe sesiuni, si pot sa vad toate setarile salvate. 

<h3 id="ip">A) Pt conectare prin IP</h3>

Pentru aceasta obtiune avem nevoie de IP-ul care a fost atribuit la Raspberry Pi, de catre Router / switch.<br>
Aici avem doua obtiuni: fie mergem in pagina de setare router, fie intram prin OBS Studio, ca si pana acum.<br>
Desi prefer sa vizualizez la router, o sa continui cu versiunea cea mai usoara, astfel incat sa intelegeti ceva.

**Step 1**<br>
Mergem cu laptop pe hol, si conectam ansamblu de micro HDMI la Raspberry Pi, iar USB-ul la PC. Deasemenea deschidem OBS Studio, pe care tocmai l-am configurat la pasii anteriori.

**Step 2**<br>
Ne logam cu userul si parola.


**Step 3**<br>
Introducem in terminal:

```
hostname -I
```

Aceasta ne va da IP-ul la care ne putem conecta. Il notam undeva, pentru pasul urmator.

**Step 4**<br>
Deschide aplicatia KiTTY.<br>
Iar la tabul *Session*, in casuta *Host Name*, introducem `user@IP`. Userul este cel de la instalare. default este `pi`. Iar la IP punem cel de la *Step 3*.<br>
La *Connection type* lasam *SSH*. Este important.<br>
Iar apoi introducem un nume sugestiv precum `Raspberry Pi`, urmat de apasat butonul *save* din dreapta.

<img src="_img/5/ssh7.PNG" alt="ssh7" />

**Step 5**<br>
Din panneul din stanga la *Connection* deschidem *SSH*, si intram pe *Auth*.<br>
De aici apasam pe *Browse* si selectam cheia ssh, salvata ca *.ppk* mai devreme. Asigura-te ca este afisata cu tot cu extensie, sau e posibil sa intampini e eroare mai tarziu.

<img src="_img/5/ssh8.PNG" alt="ssh8" />

**Step 6**<br>
Pentru consistenta, recomand sa te intorci inapoi la tabul *Session*, si sa mai apesi o data pe *save*.

**Step 7**<br>
Acum e timpul pentru conectare.<br>
selectam conexiunea salvata de la *Saved Session* si apasam fie pe *Open*, fie pe *Start*. De regula la inceput, eu aleg *Start* pentru ca e posibil sa intampini o eroare, iar astfel nu va fi nevoie sa mai deschid inca o data Aplicatia.

<img src="_img/5/ssh9.PNG" alt="ssh9" />

La prima conexiune vei intalni acest popup. Doar apasa pe*Accept*. 

**Step 8**<br>
Daca apare aceasta fereastra, este un semn bun.<br>
Introducem *pass phrase* folosita la generat cheia ssh.

<img src="_img/5/ssh10.PNG" alt="ssh10" />

**Step 9**<br>
Si gata. Ne-am logat.

<img src="_img/5/ssh11.PNG" alt="ssh11" />

<h3 id="hostname">B) Pt conectare prin domeniu</h3>

Este recomandat sa folosim aceasta versiune, intrucat IPul se poate modifica peste timp.

**Step 1**<br>
Pentru ca conectarea sa se poata face prin ssh, pentru Windows, este nevoie sa instalam aplicatia [Bonjour Printer Wizard](https://support.apple.com/en-us/106380), caci fara acasta PCul nu recunoaste nici hostname, nici hostname.local.<br>
De aceea vom instala aceasta aplicatie.

> [!NOTE]
> In caz ca nu e mai online cand citesti aceasta documentatie, poti il poti gasi in folderul *software* de sub cel principal *Raspberry Pi*.

**Step 2**<br>
Deschide aplicatia KiTTY.<br>
Iar la tabul *Session*, in casuta *Host Name*, introducem `user@host.local`. Userul este cel de la instalare. default este `pi`. Iar la host punem hostname-ul din instalare. Default este `raspberry.local`.<br>
La *Connection type* lasam *SSH*. Este important.<br>
Iar apoi introducem un nume sugestiv precum `Raspberry Pi`, urmat de apasat butonul *save* din dreapta.

<img src="_img/5/ssh12.PNG" alt="ssh12" />

**Step 3**<br>
Din panneul din stanga la *Connection* deschidem *SSH*, si intram pe *Auth*.<br>
De aici apasam pe *Browse* si selectam cheia ssh, salvata ca *.ppk* mai devreme. Asigura-te ca este afisata cu tot cu extensie, sau e posibil sa intampini e eroare mai tarziu.

<img src="_img/5/ssh8.PNG" alt="ssh8" />

**Step 4**<br>
Pentru consistenta, recomand sa te intorci inapoi la tabul *Session*, si sa mai apesi o data pe *save*.

**Step 5**<br>
Acum e timpul pentru conectare.<br>
selectam conexiunea salvata de la *Saved Session* si apasam fie pe *Open*, fie pe *Start*. De regula la inceput, eu aleg *Start* pentru ca e posibil sa intampini o eroare, iar astfel nu va fi nevoie sa mai deschid inca o data Aplicatia.

<img src="_img/5/ssh9.PNG" alt="ssh9" />

La prima conexiune vei intalni acest popup. Doar apasa pe *Accept*. 

**Step 6**<br>
Daca apare aceasta fereastra, este un semn bun.<br>
Introducem *pass phrase* folosita la generat cheia ssh.

<img src="_img/5/ssh13.PNG" alt="ssh13" />

Ca diferenta vizibila punem vedea in titlu ferestrei hostname-ul `raspberry.local` sau ce ati ales, in loc de un IP. Deasemenea in cazul meu a aparut imediat aceasta fereastra de logare.

**Step 7**<br>
Si apoi, gata. Ne-am logat.

<img src="_img/5/ssh14.PNG" alt="ssh14" />

Dupa cum se vede, avem acum `<user>@<hostname>` si in partea de titlu a ferestrei, si jos ca comanda utilizator pe verde.